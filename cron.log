#!/usr/bin/env python3
"""
Simple script to check and verify YouTube API credentials
"""
import os
import pickle
from google.oauth2.credentials import Credentials

def check_credentials():
    token_file = "/home/neosoft/Documents/YoutubeAutomation/token.pickle"
    
    if not os.path.exists(token_file):
        print("âŒ No credential file found at:", token_file)
        return False
    
    try:
        with open(token_file, 'rb') as token:
            credentials = pickle.load(token)
        
        print("âœ… Credential file loaded successfully")
        print("\nğŸ“‹ Credential Details:")
        print(f"  - Token: {'âœ… Present' if credentials.token else 'âŒ Missing'}")
        print(f"  - Refresh Token: {'âœ… Present' if credentials.refresh_token else 'âŒ Missing'}")
        print(f"  - Client ID: {'âœ… Present' if credentials.client_id else 'âŒ Missing'}")
        print(f"  - Client Secret: {'âœ… Present' if credentials.client_secret else 'âŒ Missing'}")
        print(f"  - Token URI: {credentials.token_uri if credentials.token_uri else 'âŒ Missing'}")
        print(f"  - Valid: {'âœ… Yes' if credentials.valid else 'âŒ No'}")
        print(f"  - Expired: {'âŒ Yes' if credentials.expired else 'âœ… No'}")
        
        # Check if we have all required fields for refresh
        required_fields = [
            credentials.refresh_token,
            credentials.token_uri,
            credentials.client_id,
            credentials.client_secret
        ]
        
        if all(required_fields):
            print("\nâœ… All required fields present for token refresh")
            return True
        else:
            print("\nâŒ Missing required fields for token refresh")
            print("ğŸ’¡ You need to re-authenticate to get a proper refresh token")
            return False
            
    except Exception as e:
        print(f"âŒ Error loading credentials: {e}")
        return False

def delete_credentials():
    token_file = "/home/neosoft/Documents/YoutubeAutomation/token.pickle"
    if os.path.exists(token_file):
        os.remove(token_file)
        print("ğŸ—‘ï¸ Deleted credential file. You'll need to re-authenticate.")
    else:
        print("â„¹ï¸ No credential file to delete.")

if __name__ == "__main__":
    print("ğŸ” YouTube API Credential Checker\n")
    
    if check_credentials():
        print("\nğŸ‰ Credentials look good! Your script should work.")
    else:
        print("\nğŸ”§ Credentials need to be fixed.")
        response = input("\nDelete existing credentials and force re-authentication? (y/N): ")
        if response.lower() == 'y':
            delete_credentials()
            print("\nğŸ”„ Run your main script again to re-authenticate.")
